<!DOCTYPE html>
<html lang="en">

<head>
    <title>MyStory - Login</title>
    <link rel="stylesheet" href="./styles/reset.css">
    <link rel="stylesheet" href="./styles/styles.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
        crossorigin="anonymous">
</head>

<body>
    <header>
        <iframe src="header.html" width="100%"></iframe>
    </header>
    <div class="container">
        <section>
            <h1 class="title">Profile</h1>
            <!-- First Name -->
            <div>
                <label for="first-name">First Name</label>
                <span id="first-name"></span>
            </div>
            <!-- Last Name -->
            <div>
                <label for="first-name">Last Name</label>
                <span id="last-name"></span>
            </div>
            <!-- Alias -->
            <div>
                <label for="alias">Alias</label>
                <span id="alias"></span>
            </div>
            <!-- Email -->
            <div>
                <label for="email">Email</label>
                <span id="email"></span>
            </div>
            <!-- Gender -->
            <div>
                <label for="gender">How do you gender identify?</label>
                <span id="gender"></span>
            </div>
            <!-- DOB -->
            <div>
                <label for="DOB">Date of Birth</label>
                <span id="dob"></span>
            </div>
            <div class="buttons">
                <input id="back-button" class="button" type="submit" value="Back" />
                <a href="edit-profile.html">Edit</a>
            </div>
        </section>
    </div>
    <footer>
        <iframe class="footer" src="footer.html" width="100%"></iframe>
    </footer>

    <script src="./src/profiles.js"></script>
    <script>
        window.onload = function (e) {
            // debugger;

            // Checked user is logged in
            if (typeof window.sessionStorage.loggedIn === "undefined" || window.sessionStorage.loggedIn === null || window.sessionStorage.loggedIn === "") {
                alert("You need to be logged in first.");
                window.location.href = "./login.3.html";
            }

            const results = loadProfile();

            displayProfile(results.profile);
        };

        var displayProfile = function (profile) {
            // let profile;
            // let foundProfile = false;

            // // Load profiles from storage
            // const profiles = window.localStorage.profiles ? JSON.parse(window.localStorage.profiles) : [];

            // // Loop through list of profiles to find my profile
            // for (let index = 0; index < profiles.length; index++) {
            //     profile = profiles[index];

            //     if (profile.email === window.sessionStorage.loggedIn) {
            //         foundProfile = true;

            //         break;
            //     }
            // }

            // Display my profile if found
            if (profile != null) {
                document.getElementById("first-name").innerHTML = profile.firstName;
                document.getElementById("last-name").innerHTML = profile.lastName;
                document.getElementById("alias").innerHTML = profile.alias;
                document.getElementById("email").innerHTML = profile.email;
                document.getElementById("gender").innerHTML = profile.gender;
                document.getElementById("dob").innerHTML = profile.dob;
            } else {  // Otherwise display error message and redirect user to login screen
                alert("You don't have a profile buddy!");
                window.location.href = "./sign-up.html";
            }
        }
    </script>
</body>

</html>